resources:
  - dashboard-deployment.yaml
  - dashboard-service.yaml
  - ingress-route.yaml

replacements:
  - source:
      kind: Deployment
      name: ns-dashboard
      fieldPath: metadata.name
    targets:
      - select:
          kind: Deployment
          name: ns-dashboard
        fieldPaths:
          - spec.selector.matchLabels.app
          - spec.template.metadata.labels.app
      - select:
          kind: Service
          name: ns-dashboard
        fieldPaths:
          - spec.selector.app
  - source:
      kind: IngressRoute
      name: ns-preview
      fieldPath: metadata.annotations.app/param-host
    targets:
      - select:
          kind: IngressRoute
          name: ns-preview
        fieldPaths:
          - spec.routes.0.match
  - source:
      kind: IngressRoute
      name: ns-preview
      fieldPath: metadata.annotations.app/param-host-backend
    targets:
      - select:
          kind: IngressRoute
          name: ns-preview
        fieldPaths:
          - spec.routes.1.match

configurations:
  - kustomization-config.yaml
