apiVersion: apps/v1
kind: Deployment
metadata:
  name: debug

spec:
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: debug
  template:
    metadata:
      labels:
        app: debug
    spec:
      enableServiceLinks: false
      volumes:
        - name: data
          persistentVolumeClaim:
            claimName: traq-ranking
      containers:
        - name: traq-ranking
          image: ghcr.io/motoki317/traq-ranking:master
          imagePullPolicy: Always
          command:
            - sleep
          args:
            - infinity
          volumeMounts:
            - mountPath: /data
              name: data
          env:
            - name: BASE_PATH
              valueFrom:
                configMapKeyRef:
                  name: traq-ranking-toki317-dev
                  key: base-path
            - name: TARGET_CHANNEL_ID
              valueFrom:
                configMapKeyRef:
                  name: traq-ranking-toki317-dev
                  key: target-channel
            - name: ACCESS_TOKEN
              valueFrom:
                secretKeyRef:
                  name: traq-ranking-toki317-dev
                  key: access-token
            - name: DAILY_RANKING_SAVE_FILE
              valueFrom:
                configMapKeyRef:
                  name: traq-ranking-toki317-dev
                  key: save-file
