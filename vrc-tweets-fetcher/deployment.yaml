kind: Deployment
apiVersion: apps/v1
metadata:
  name: vrc-tweets-fetcher

spec:
  replicas: 1
  selector:
    matchLabels:
      app: vrc-tweets-fetcher
  template:
    metadata:
      labels:
        app: vrc-tweets-fetcher
    spec:
      enableServiceLinks: false
      containers:
        - name: vrc-tweets-fetcher
          image: ghcr.io/motoki317/vrc-world-tweets-fetcher:master
          args:
            - listen
          env:
            - name: HANDLERS
              valueFrom:
                secretKeyRef:
                  name: vrc-tweets-fetcher
                  key: handlers
            - name: TWITTER_BEARER_TOKEN
              valueFrom:
                secretKeyRef:
                  name: vrc-tweets-fetcher
                  key: twitter-token
            - name: MYSQL_HOST
              value: mariadb.db.svc.cluster.local
            - name: MYSQL_PORT
              value: "3306"
            - name: MYSQL_USERNAME
              value: vrc_fetcher
            - name: MYSQL_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: vrc-tweets-fetcher
                  key: mysql-password
            - name: MYSQL_DATABASE
              value: vrc_fetcher
